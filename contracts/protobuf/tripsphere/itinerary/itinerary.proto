syntax = "proto3";

package tripsphere.itinerary;

option java_multiple_files = true;
option java_package = "org.tripsphere.itinerary";
option java_outer_classname = "ItineraryProto";

// Itinerary Planner Service - Uses LangGraph for intelligent planning
service ItineraryPlannerService {
  // Plan an itinerary based on user preferences and constraints
  rpc PlanItinerary(PlanItineraryRequest) returns (PlanItineraryResponse) {}
  
  // Refine an existing itinerary
  rpc RefineItinerary(RefineItineraryRequest) returns (RefineItineraryResponse) {}
}

message PlanItineraryRequest {
  string user_id = 1;
  string destination = 2;
  string start_date = 3;  // ISO 8601 format
  string end_date = 4;    // ISO 8601 format
  repeated string interests = 5;  // e.g., ["culture", "food", "adventure"]
  string budget_level = 6;  // e.g., "budget", "moderate", "luxury"
  int32 num_travelers = 7;
  map<string, string> preferences = 8;  // Additional preferences
}

message PlanItineraryResponse {
  string itinerary_id = 1;
  string status = 2;  // e.g., "success", "error"
  Itinerary itinerary = 3;
  string message = 4;
}

message RefineItineraryRequest {
  string itinerary_id = 1;
  string user_id = 2;
  string refinement_instructions = 3;  // Natural language instructions
  map<string, string> modifications = 4;  // Structured modifications
}

message RefineItineraryResponse {
  string status = 1;
  Itinerary itinerary = 2;
  string message = 3;
}

message Itinerary {
  string id = 1;
  string destination = 2;
  string start_date = 3;
  string end_date = 4;
  repeated DayPlan day_plans = 5;
  Summary summary = 6;
  string created_at = 7;
  string updated_at = 8;
}

message DayPlan {
  int32 day_number = 1;
  string date = 2;
  repeated Activity activities = 3;
  string notes = 4;
}

message Activity {
  string id = 1;
  string name = 2;
  string description = 3;
  string start_time = 4;
  string end_time = 5;
  Location location = 6;
  string category = 7;  // e.g., "sightseeing", "dining", "transportation"
  EstimatedCost cost = 8;
}

message Location {
  string name = 1;
  double latitude = 2;
  double longitude = 3;
  string address = 4;
}

message EstimatedCost {
  double amount = 1;
  string currency = 2;
}

message Summary {
  double total_estimated_cost = 1;
  string currency = 2;
  int32 total_activities = 3;
  repeated string highlights = 4;
}
