syntax = "proto3";

package tripsphere.attraction;

import "tripsphere/common/geo.proto";
import "tripsphere/file/file.proto";

option go_package = "tripsphere/attraction";
option java_multiple_files = true;
option java_package = "org.tripsphere.attraction";

message Attraction {
  string id = 1;
  string name = 2;
  tripsphere.common.Address address = 3;
  string introduction = 4;
  repeated string tags = 5;
  repeated tripsphere.file.File images = 6;
  tripsphere.common.Location location = 7;
}

message AddAttractionRequest {
  Attraction attraction = 1;
}

message AddAttractionResponse {
  string id = 1; //attraction id
}

message DeleteAttractionRequest {
  string id = 1;
}

message DeleteAttractionResponse {
  bool success = 1;
}

message ChangeAttractionRequest {
  Attraction attraction = 1;
}

message ChangeAttractionResponse {
  bool success = 1;
}

message FindIdByNameRequest {
  string name = 1;
}

message FindIdByNameResponse {
  string attraction_id = 1;
}

message FindAttractionByIdRequest {
  string id = 1;
}

message FindAttractionByIdResponse {
  Attraction attraction = 1;
}

message AttractionPage {
  repeated Attraction content = 1; // content of page
  int32 total_pages = 2; //total number of pages
  int64 total_elements = 3; // total number of attractions
  int32 size = 4; // the size of page
  int32 number = 5; // size number, start from 0
  bool first = 6; // if this page is first page
  bool last = 7; // if this page is last page
  int32 number_of_elements = 8; // the actual number of attraction on this page
}

message FindAttractionsWithinRadiusPageRequest {
  tripsphere.common.Location location = 1;
  double radius_km = 2;
  int32 number = 3; // page number
  int32 size = 4; // page size
  string name = 5;
  repeated string tags = 6;
}

message FindAttractionsWithinRadiusPageResponse {
  AttractionPage attraction_page = 1;
}

message FindAttractionsWithinCirclePageRequest {
  tripsphere.common.Location location = 1;
  double radius_km = 2;
  int32 number = 3; // page number
  int32 size = 4; // page size
  string name = 5;
  repeated string tags = 6;
}

message FindAttractionsWithinCirclePageResponse {
  AttractionPage attraction_page = 1;
}

message FindAttractionsWithinRadiusRequest {
  tripsphere.common.Location location = 1;
  double radius_km = 2;
  string name = 3;
  repeated string tags = 4;
}

message FindAttractionsWithinRadiusResponse {
  repeated Attraction content = 1;
}

message FindAttractionsWithinCircleRequest {
  tripsphere.common.Location location = 1;
  double radius_km = 2;
  string name = 3;
  repeated string tags = 4;
}

message FindAttractionsWithinCircleResponse {
  repeated Attraction content = 1;
}

service AttractionService {
  rpc AddAttraction(AddAttractionRequest) returns (AddAttractionResponse);
  rpc DeleteAttraction(DeleteAttractionRequest) returns (DeleteAttractionResponse);
  rpc ChangeAttraction(ChangeAttractionRequest) returns (ChangeAttractionResponse);
  rpc FindIdByName(FindIdByNameRequest) returns (FindIdByNameResponse);
  rpc FindAttractionById(FindAttractionByIdRequest) returns (FindAttractionByIdResponse);
  //Find attractions located at the specified location and within the specified distance range
  //and list them in order from near to far, and result has been paginated
  rpc FindAttractionsWithinRadiusPage(FindAttractionsWithinRadiusPageRequest) returns (FindAttractionsWithinRadiusPageResponse);

  //Find attractions located at the specified location and within the specified distance range
  //and result has been paginated
  rpc FindAttractionsWithinCirclePage(FindAttractionsWithinCirclePageRequest) returns (FindAttractionsWithinCirclePageResponse);

  //Find attractions located at the specified location and within the specified distance range
  //and list them in order from near to far
  rpc FindAttractionsWithinRadius(FindAttractionsWithinRadiusRequest) returns (FindAttractionsWithinRadiusResponse);

  //Find attractions located at the specified location and within the specified distance range
  rpc FindAttractionsWithinCircle(FindAttractionsWithinCircleRequest) returns (FindAttractionsWithinCircleResponse);
}
